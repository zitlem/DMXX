import{_ as B,u as O,r as d,o as q,c as s,b as t,x as M,d as g,F as _,l as S,n as H,t as i,e as h,s as G,v as N,f as l}from"./index-BCRoANWK.js";const J={class:"remote-api-container"},W={class:"card"},z={class:"data-table"},Y={class:"truncate-cell"},K={class:"truncate-cell"},Q={class:"truncate-cell"},X={class:"action-cell"},Z=["onClick"],ee=["onClick"],te=["onClick"],oe=["onClick"],ae={key:0},se={class:"token-actions"},le={key:0,class:"modal-overlay"},ne={class:"modal"},de={class:"modal-header"},re={class:"form-group"},ie=["value"],ce={class:"form-group"},ue={class:"modal-footer"},pe=["disabled"],ve={key:1,class:"modal-overlay"},me={class:"modal"},be={class:"modal-header"},ke={class:"form-group"},ye=["value"],fe={class:"form-group"},ge={class:"modal-footer"},_e=["disabled"],he={key:2,class:"modal-overlay"},Ce={class:"modal"},Te={class:"modal-header"},we={style:{"margin-bottom":"12px"}},xe={class:"form-group"},Se={class:"token-url-box"},$e={class:"modal-footer"},Fe={__name:"RemoteAPI",setup(Ue){const A=O(),C=d([]),$=d([]),F=d([]),u=d(!1),p=d(!1),v=d(null),m=d(null),k=d(""),y=d(""),r=d(null);async function c(a,e={}){const o={...e.headers,...A.getAuthHeaders()};return fetch(a,{...e,headers:o})}q(async()=>{await Promise.all([f(),D(),L()])});async function f(){try{const a=await c("/api/remote/tokens");if(a.ok){const e=await a.json();C.value=e.tokens}}catch(a){console.error("Failed to load remote tokens:",a)}}async function D(){try{const a=await c("/api/groups");if(a.ok){const e=await a.json();$.value=e.groups.filter(o=>o.enabled)}}catch(a){console.error("Failed to load groups:",a)}}async function L(){try{const a=await c("/api/scenes");if(a.ok){const e=await a.json();F.value=e.scenes}}catch(a){console.error("Failed to load scenes:",a)}}function R(a){return a.token_type==="scene"?a.scene_name||`Scene ${a.scene_id}`:a.token_type==="group"?a.group_name||`Group ${a.group_id}`:a.token_type==="blackout"?"Blackout toggle":a.token_type==="status"?"System status":"-"}function E(a){if(!a)return"";const e=new Date(a);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}async function T(a,e=null,o=null){try{const n={token_type:a,name:o};a==="group"&&e&&(n.group_id=e);const b=await c("/api/remote/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(b.ok){const x=await b.json();r.value=x,await f()}else{const x=await b.json();alert(x.detail||"Failed to create token")}}catch(n){console.error("Failed to create token:",n),alert("Failed to create token")}}async function P(){await T("group",v.value,k.value||null),u.value=!1,v.value=null,k.value=""}async function j(){try{const a={token_type:"scene",scene_id:m.value,name:y.value||null},e=await c("/api/remote/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(e.ok){const o=await e.json();r.value=o,await f()}else{const o=await e.json();alert(o.detail||"Failed to create token")}}catch(a){console.error("Failed to create token:",a),alert("Failed to create token")}p.value=!1,m.value=null,y.value=""}async function V(a){if(confirm(`Delete this ${a.token_type} token? It will stop working immediately.`))try{(await c(`/api/remote/tokens/${a.id}`,{method:"DELETE"})).ok&&await f()}catch(e){console.error("Failed to delete token:",e)}}async function U(a){try{return await navigator.clipboard.writeText(a),!0}catch{const o=document.createElement("textarea");o.value=a,o.style.position="fixed",o.style.left="-9999px",document.body.appendChild(o),o.select();try{return document.execCommand("copy"),!0}catch{return!1}finally{document.body.removeChild(o)}}}async function w(a,e=null){let o=a.trigger_url;e&&a.token_type==="blackout"&&(o=o+`&state=${e}`);const n=await U(o),b=e?`Blackout ${e.toUpperCase()}`:"URL";alert(n?`${b} copied to clipboard!`:"Failed to copy. Please copy manually.")}async function I(){if(r.value){const a=await U(r.value.trigger_url);alert(a?"URL copied to clipboard!":"Failed to copy.")}}return(a,e)=>(l(),s("div",J,[e[26]||(e[26]=t("h2",null,"Remote API",-1)),e[27]||(e[27]=t("p",{class:"description"}," Create tokens for remote control via HTTP requests. Use these with Home Assistant, StreamDeck, or other automation tools. ",-1)),t("div",W,[e[16]||(e[16]=t("div",{class:"card-header"},[t("h3",{class:"card-title"},"API Tokens")],-1)),t("table",z,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Target"),t("th",null,"Last Used"),t("th",null,"Actions")])],-1)),t("tbody",null,[(l(!0),s(_,null,S(C.value,o=>(l(),s("tr",{key:o.id},[t("td",null,[t("span",{class:H(["token-type-badge",o.token_type])},i(o.token_type),3)]),t("td",Y,i(o.name||"Unnamed"),1),t("td",K,i(R(o)),1),t("td",Q,i(o.last_used?E(o.last_used):"Never"),1),t("td",X,[o.token_type==="blackout"?(l(),s(_,{key:0},[t("button",{class:"btn btn-small btn-secondary",onClick:n=>w(o,"on")},"Copy ON",8,Z),t("button",{class:"btn btn-small btn-secondary",onClick:n=>w(o,"off")},"Copy OFF",8,ee)],64)):(l(),s("button",{key:1,class:"btn btn-small btn-secondary",onClick:n=>w(o)},"Copy URL",8,te)),t("button",{class:"btn btn-small btn-danger",onClick:n=>V(o)},"Delete",8,oe)])]))),128)),C.value.length===0?(l(),s("tr",ae,[...e[14]||(e[14]=[t("td",{colspan:"5",class:"empty-message"}," No remote API tokens yet ",-1)])])):g("",!0)])]),t("div",se,[t("button",{class:"btn btn-secondary",onClick:e[0]||(e[0]=o=>p.value=!0)}," + Scene Token "),t("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=o=>u.value=!0)}," + Group Token "),t("button",{class:"btn btn-secondary",onClick:e[2]||(e[2]=o=>T("blackout"))}," + Blackout Token "),t("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=o=>T("status"))}," + Status Token ")])]),e[28]||(e[28]=M('<div class="card" data-v-c61b9da5><div class="card-header" data-v-c61b9da5><h3 class="card-title" data-v-c61b9da5>Usage Examples</h3></div><div class="examples" data-v-c61b9da5><div class="example" data-v-c61b9da5><h4 data-v-c61b9da5>Trigger Scene</h4><code data-v-c61b9da5>GET /api/remote/scene/{&quot;{scene_id}&quot;}?token=xxx</code></div><div class="example" data-v-c61b9da5><h4 data-v-c61b9da5>Toggle Blackout</h4><code data-v-c61b9da5>GET /api/remote/blackout?token=xxx</code><p data-v-c61b9da5>Add <code data-v-c61b9da5>&amp;state=on</code> or <code data-v-c61b9da5>&amp;state=off</code> to set specific state</p></div><div class="example" data-v-c61b9da5><h4 data-v-c61b9da5>Set Group Value</h4><code data-v-c61b9da5>GET /api/remote/group/{&quot;{group_id}&quot;}?token=xxx&amp;value=128</code><p data-v-c61b9da5>Value is 0-255</p></div><div class="example" data-v-c61b9da5><h4 data-v-c61b9da5>Get Status</h4><code data-v-c61b9da5>GET /api/remote/status?token=xxx</code><p data-v-c61b9da5>Returns current blackout state, groups, and universes</p></div></div></div>',1)),p.value?(l(),s("div",le,[t("div",ne,[t("div",de,[e[17]||(e[17]=t("h3",{class:"modal-title"},"Create Scene Token",-1)),t("button",{class:"modal-close",onClick:e[4]||(e[4]=o=>p.value=!1)},"×")]),t("div",re,[e[18]||(e[18]=t("label",{class:"form-label"},"Select Scene",-1)),h(t("select",{class:"form-select","onUpdate:modelValue":e[5]||(e[5]=o=>m.value=o)},[(l(!0),s(_,null,S(F.value,o=>(l(),s("option",{key:o.id,value:o.id},i(o.name),9,ie))),128))],512),[[G,m.value]])]),t("div",ce,[e[19]||(e[19]=t("label",{class:"form-label"},"Token Name (optional)",-1)),h(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[6]||(e[6]=o=>y.value=o),placeholder:"e.g., Stage Wash StreamDeck"},null,512),[[N,y.value]])]),t("div",ue,[t("button",{class:"btn btn-secondary",onClick:e[7]||(e[7]=o=>p.value=!1)},"Cancel"),t("button",{class:"btn btn-primary",onClick:j,disabled:!m.value},"Create",8,pe)])])])):g("",!0),u.value?(l(),s("div",ve,[t("div",me,[t("div",be,[e[20]||(e[20]=t("h3",{class:"modal-title"},"Create Group Token",-1)),t("button",{class:"modal-close",onClick:e[8]||(e[8]=o=>u.value=!1)},"×")]),t("div",ke,[e[21]||(e[21]=t("label",{class:"form-label"},"Select Group",-1)),h(t("select",{class:"form-select","onUpdate:modelValue":e[9]||(e[9]=o=>v.value=o)},[(l(!0),s(_,null,S($.value,o=>(l(),s("option",{key:o.id,value:o.id},i(o.name),9,ye))),128))],512),[[G,v.value]])]),t("div",fe,[e[22]||(e[22]=t("label",{class:"form-label"},"Token Name (optional)",-1)),h(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[10]||(e[10]=o=>k.value=o),placeholder:"e.g., House Lights StreamDeck"},null,512),[[N,k.value]])]),t("div",ge,[t("button",{class:"btn btn-secondary",onClick:e[11]||(e[11]=o=>u.value=!1)},"Cancel"),t("button",{class:"btn btn-primary",onClick:P,disabled:!v.value},"Create",8,_e)])])])):g("",!0),r.value?(l(),s("div",he,[t("div",Ce,[t("div",Te,[e[23]||(e[23]=t("h3",{class:"modal-title"},"Token Created",-1)),t("button",{class:"modal-close",onClick:e[12]||(e[12]=o=>r.value=null)},"×")]),t("p",we,"Your new "+i(r.value.token_type)+" token has been created.",1),t("div",xe,[e[24]||(e[24]=t("label",{class:"form-label"},"Trigger URL",-1)),t("div",Se,[t("code",null,i(r.value.trigger_url),1)])]),e[25]||(e[25]=t("p",{class:"warning-text"}," Save this URL now. For security, the full token won't be shown again. ",-1)),t("div",$e,[t("button",{class:"btn btn-secondary",onClick:I},"Copy URL"),t("button",{class:"btn btn-primary",onClick:e[13]||(e[13]=o=>r.value=null)},"Done")])])])):g("",!0)]))}},Ne=B(Fe,[["__scopeId","data-v-c61b9da5"]]);export{Ne as default};
