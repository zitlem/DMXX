import{u as h,r as a,o as x,a as _,c,b as e,d as g,t as r,w as b,e as P,v as k,f as d}from"./index-BCRoANWK.js";const I={class:"login-container"},L={class:"card login-card"},M={key:0,class:"alert alert-error"},S={class:"form-group"},C=["disabled"],D={key:1,style:{"margin-top":"16px","text-align":"center"}},B={style:{"text-align":"center","margin-top":"16px","font-size":"12px",color:"var(--text-secondary)"}},X={__name:"Login",setup(N){const p=_(),s=h(),i=a(""),n=a(""),l=a(!1),f=a(""),u=a("");x(async()=>{if(f.value=s.clientIp,s.authenticated){const o=s.allowedPages[0]||"faders";p.push(`/${o}`)}else await v()});async function v(){try{const t=await(await fetch("/api/auth/status")).json();t.authenticated&&t.profile_name&&(u.value=t.profile_name)}catch{}}function m(){localStorage.removeItem("dmxx_logged_out"),window.location.reload()}async function y(){n.value="",l.value=!0;try{await s.login(i.value);const o=s.allowedPages[0]||"faders";p.push(`/${o}`)}catch(o){n.value=o.message}finally{l.value=!1}}return(o,t)=>(d(),c("div",I,[e("div",L,[t[3]||(t[3]=e("h1",{class:"login-title"},"DMXX",-1)),t[4]||(t[4]=e("p",{style:{"text-align":"center",color:"var(--text-secondary)","margin-bottom":"24px"}}," DMX Lighting Controller ",-1)),n.value?(d(),c("div",M,r(n.value),1)):g("",!0),e("form",{onSubmit:b(y,["prevent"])},[e("div",S,[t[1]||(t[1]=e("label",{class:"form-label"},"Password",-1)),P(e("input",{type:"password",class:"form-input","onUpdate:modelValue":t[0]||(t[0]=w=>i.value=w),placeholder:"Enter password",autofocus:""},null,512),[[k,i.value]])]),e("button",{type:"submit",class:"btn btn-primary",style:{width:"100%"},disabled:l.value},r(l.value?"Logging in...":"Login"),9,C)],32),u.value?(d(),c("div",D,[t[2]||(t[2]=e("p",{style:{"font-size":"12px",color:"var(--text-secondary)","margin-bottom":"8px"}}," Or continue without password: ",-1)),e("button",{class:"btn btn-secondary",style:{width:"100%"},onClick:m}," Continue as "+r(u.value),1)])):g("",!0),e("p",B," Your IP: "+r(f.value),1)])]))}};export{X as default};
